<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EVP5MJERRY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-EVP5MJERRY');
    </script>
    <!-- Meta Pixel Code -->
    <script>
        function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '827137978479661');
        fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
                   src="https://www.facebook.com/tr?id=827137978479661&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
    <!-- Hotjar Tracking Code for https://villagelife.bg -->
    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:3202998,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    <meta charset="UTF-8">
    <title th:text="#{village} + ' ' + ${villageInfo.villageDTO.name} + ', ' + #{region} + ' ' + #{${villageInfo.villageDTO.region}}"></title>
    <link th:href="@{/images/village-life-logo-icon.png}" rel="icon" type="image/png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
            integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
            crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/css/message.css">
    <link rel="stylesheet" href="/css/showVillageById.css">
    <link rel="stylesheet" href="/css/menu-style-about-us.css">


    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.2/js/bootstrap-select.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.6.2/css/bootstrap-select.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/0.8.2/css/flag-icon.min.css" rel="stylesheet" />

    <script src="https://www.youtube.com/iframe_api"></script>

</head>
<body>

<div th:replace="fragments :: menu"></div>
<div th:replace="fragments :: hamburger-menu"></div>

<div class="container">
    <div class="village-title">
        <h1>
            <span th:text="#{village}"></span>
            <span th:if="${#locale.language == 'bg'}" th:text="${villageInfo.villageDTO.name} + ', '"></span>
            <span th:if="${#locale.language == 'en'}" th:text="${villageInfo.villageDTO.latinName} + ', '"></span>
            <span th:if="${#locale.language == 'de'}" th:text="${villageInfo.villageDTO.latinName} + ', '"></span>
            <span th:text="#{region}"></span>
            <span th:text="#{${villageInfo.villageDTO.region}}"></span>
        </h1>

        <input value='' type='button' onclick='handlePrint()' class="print-button"/>
        <button id="toggleButton">
            <i class="fa-regular fa-image" id="toggleBtnIcon"></i>
            <span id="text-video" th:text="#{text.video}" class="hidden" ></span>
            <span id="text-images" th:text="#{text.images}"></span>
        </button>

        <img th:src="@{/images/point.png}" class="point-icon"><span th:text="#{village}"></span>
        <span th:if="${#locale.language == 'bg'}" th:text="${villageInfo.villageDTO.name} + ', '"></span>
        <span th:if="${#locale.language == 'en'}" th:text="${villageInfo.villageDTO.latinName} + ', '"></span>
        <span th:if="${#locale.language == 'de'}" th:text="${villageInfo.villageDTO.latinName} + ', '"></span>
        <span th:text="#{bulgaria}"></span>
    </div>

    <div id="images" class="hidden">
        <div th:each="imageSrc, i : ${imageSrcList}" class="mySlides">
            <div class="village-image-container text-center">
                <div class="numbertext" th:text="${i.index + 1} + ' / ' + ${imageSrcList.size()}"></div>

                <img th:src="'data:image/jpeg;base64,' + ${imageSrc}"
                     onerror="this.onerror=null;this.src='/images/pexels-alexander-kovalev-2871478.jpg';" id="img">

                <a class="prev" th:if="${imageSrcList.size() > 1}" onclick="plusSlides(-1)">❮</a>
                <a class="next" th:if="${imageSrcList.size() > 1}" onclick="plusSlides(1)">❯</a>
            </div>
        </div>
    </div>

    <div id="video-container"></div>

    <div th:if="${admin != null}" class="row justify-content-center mt-3">
        <div class="col-sm-4">
            <form th:action="@{/admins/approve/{villageId}(villageId=${villageInfo.villageDTO.id})}" method="post"
                  class="btn-group btn-equal-size text-center">
                <input type="hidden" name="villageId" th:value="${villageInfo.villageDTO.id}">
                <input type="hidden" name="answerDate" th:value="${answerDate}">
                <button type="submit" class="btn btn-success" onclick="return showConfirmationApprove()">Одобри отговор</button>
            </form>
        </div>
        <div class="col-sm-4">
            <form th:if="${status != 'archived'}" id="rejectForm" th:action="@{/admins/reject/{villageId}(villageId=${villageInfo.villageDTO.id})}" method="post"
                  class="btn-group btn-equal-size text-center">
                <input type="hidden" name="villageId" th:value="${villageInfo.villageDTO.id}">
                <input type="hidden" name="answerDate" th:value="${answerDate}">
                <button type="submit" class="btn btn-primary" onclick="return showConfirmation()">Отхвърли отговор</button>
            </form>
            <p th:if="${status == 'archived'}" class="text-center" style="font-size: 1.2rem; font-weight: bold;">Този отговор вече е отхвърлен</p>
        </div>
        <div class="col-sm-4">
            <form th:if="${status != 'archived'}" th:action="@{/admins/village}" method="get" class="btn-group btn-equal-size text-center">
                <button type="submit" class="btn btn-danger">Назад към менюто</button>
            </form>
            <form th:if="${status == 'archived'}" th:action="@{/admins/getRejected}" method="get" class="btn-group btn-equal-size text-center">
                <button type="submit" class="btn btn-danger">Назад към архивираните села</button>
            </form>
        </div>
    </div>

    <div class="row">

        <!--<p style="color: #B5B5B5; margin-top: 20px">
            <span th:text="#{info.count1}"></span><span th:if="${admin == null}" style="padding: 0px; margin: 0px;"><span th:text="#{info.count2}" style="padding: 0px; margin: 0px;"></span> <span th:text="${villageInfo.villageDTO.approvedResponsesCount}" style="padding: 0px; margin: 0px;"></span> <span th:text="#{info.count3}" style="padding: 0px; margin: 0px;"></span><span th:if="${villageInfo.villageDTO.approvedResponsesCount != 1}" style="padding: 0px; margin: 0px;"><span th:text="#{info.count4}" style="padding: 0px; margin: 0px;"></span></span>.</span>
        </p>-->

    <div class="col-lg-8 col-md-12 col-sm-12">
        <section class="general-information">
            <h3 class="section-title" th:text="#{general.info}"></h3>
            <div class="row">
                <hr>
                <div class="col-lg-3 col-md-6 col-sm-6">
                    <div th:text="${villageInfo.populationDTO.populationCount}" class="village-info"></div>
                    <div class="info-title" th:text="#{population.count}"></div>
                </div>

                <div class="col-lg-3 col-md-6 col-sm-6" th:each="condition : ${villageInfo.livingConditionResponses}"
                     th:if="${condition.livingCondition == 'living.conditions.label' or condition.livingCondition == 'crime' or condition.livingCondition == 'environmental.friendliness'}">
                    <div th:if="${condition.percentage == 0 and condition.livingCondition != 'crime'}">
                        <div class="village-info">-</div>
                    </div>
                    <div th:unless="${condition.percentage == 0 and condition.livingCondition != 'crime'}">
                        <div class="village-info" th:text="${condition.percentage + '%'}"></div>
                    </div>
                    <div class="info-title" th:text="#{${condition.livingCondition}}"></div>
                </div>

            </div>
        </section>

        <section class="population">
            <h3 class="section-title">
                <img th:src="@{/images/crowd.png}" alt="distance" class="object-icon">
                <span th:text="#{population.count}"></span>
            </h3>
            <div class="row">
                <hr>
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{population.colon}"></span>
                                <span th:text="${villageInfo.populationDTO.populationCount}" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{children.colon}"></span>
                                <span th:text="#{${villageInfo.populationDTO.children.name}}" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{under.fifty}"></span>
                                <span th:text="#{${villageInfo.populationDTO.residents.name}}" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{foreigners}"></span>
                                <span th:text="#{${villageInfo.populationDTO.foreigners.name}}" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row ethnicities-row">
                <div class="col-lg-12 col-md-12 col-sm-12 ethnicities-col">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div>
                                <span class="info-title col" th:text="#{village.ethnicities}"></span>
                                <span th:each="ethnicity, iterStat : ${villageInfo.ethnicities}" class="ethnicities village-info" style="display: inline; padding-left: 4px; margin: 0; float: right;">
                                    <span th:text="#{${ethnicity}}"></span><span th:if="${!iterStat.first}">, </span>
                                </span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="population-assertions" th:if="${not #lists.isEmpty(villageInfo.populationAssertionResponses)}">
            <h3 class="section-title" th:text="#{population.characteristics}"></h3>
            <div class="row">
                <hr>
                <div class="col-lg-6 col-md-6 col-sm-12" th:each="assertion : ${villageInfo.populationAssertionResponses}">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{${assertion.populationAssertionName}}"></span>
                                <span th:text="${assertion.percentage} + '%'" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="living-conditions">
            <h3 class="section-title" th:text="#{living.conditions}"></h3>
            <hr>
            <div class="row groundCategory-row">
                <div class="col-lg-12 col-md-12 col-sm-12 groundCategory-col">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div>
                                <span class="info-title col" th:text="#{ground.category}"></span>
                                <span th:each="category, iterStat : ${villageInfo.groundCategories}" class="village-info col" style="display: inline; padding-left: 4px; margin: 0; float: right;">
                                    <span th:text="#{${category}}"></span><span th:if="${!iterStat.first}">, </span>
                                </span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-12" th:each="condition : ${villageInfo.livingConditionResponses}" th:if="${condition.livingCondition != 'living.conditions.label' and condition.livingCondition != 'crime' and condition.livingCondition != 'environmental.friendliness'}">
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="col-lg-11 col-md-11 col-sm-11">
                            <div class="row">
                                <span class="info-title col" th:text="#{${condition.livingCondition}}"></span>
                                <span th:text="${condition.livingCondition == 'accessibility' and condition.percentage == 0} ? '-' : (${condition.percentage} + '%')" class="village-info col"></span>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="question-answers"  th:if="${not #lists.isEmpty(villageInfo.answersQuestionResponses)}">
            <h3 class="section-title">
                <img th:src="@{/images/answer.png}" alt="distance" class="object-icon">
                <span th:text="#{more.info}"></span>
            </h3>

            <div class="accordion-container" th:each="answersQuestionResponse : ${villageInfo.answersQuestionResponses}">
                <span th:if="${admin} == null and ${answersQuestionResponse.question} != inform_message.eighth or ${admin} != null">
                    <button class="accordion" th:text="#{${answersQuestionResponse.question}}" ></button>
                    <div class="panel">
                        <div class="answer-container" th:each="answer : ${answersQuestionResponse.answers}">
                            <p th:text="${answer}" class="answer"></p>
                            <hr>
                        </div>
                    </div>
                </span>
            </div>
        </section>

        <section class="objects" th:if="${not #lists.isEmpty(villageInfo.objectVillageResponses)}">
            <h3 class="section-title" th:text="#{objects}"></h3>
            <hr>
            <table  class="table">
                <tbody>
                <tr th:each="objectVillageResponse : ${villageInfo.objectVillageResponses}">
                    <td class="col-3 info-title">
                        <span th:text="#{${objectVillageResponse.distance.name}}"></span>
                    </td>
                    <td class="col-10">
                        <img th:src="@{/images/building.png}" alt="distance" class="object-icon" src="">
                        <span th:each="object, iterStat : ${objectVillageResponse.objects}">
                            <span th:text="#{${object.type}}"></span><span th:if="${!iterStat.last}">, </span>
                        </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </section>
    </div>

    <div class="col-lg-4 col-md-12 col-sm-12 sticky-form">

        <div class="lightbox-form-wrap">
            <div class="property-form-wrap">
                <div class="property-form clearfix">
                    <form method="post" action="/villages/show/{id}" class="details" th:action="@{/villages/show/{id}(id=${villageInfo.villageDTO.id})}" th:object="${inquiry}">
                        <div class="d-flex align-items-center text-center">
                            <div class="image-wrap">
                                <img class="rounded lazyload" src="/images/village-life-logo-circle.png"
                                     alt="VillageLife" width="70" height="70"
                                     decoding="async">
                                <noscript>
                                    <img class="rounded" src="/images/village-life-logo-circle.png"
                                         alt="VillageLife" width="70" height="70">
                                </noscript>
                            </div>
                            <ul class="information-wrap list-unstyled">
                                <li class="name"><i class="houzez-icon icon-single-neutral mr-1"></i> VillageLife</li>
                            </ul>
                        </div>


                        <input type="hidden" name="villageId" th:value="${villageInfo.villageDTO.id}">

                        <div class="form-group">
                            <input class="form-control-sm" name="name" value type="text"
                                   th:placeholder="#{contacts.nameLabel}" th:field="*{userName}" minlength="2" required>
                            <ul class="error-list">
                                <li th:each="err : ${#fields.errors('userName')}" th:text="#{${err}}" class="error text-danger"></li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <input class="form-control-sm" name="mobile" value type="text"
                                   th:placeholder="#{phone}" th:field="*{mobile}" minlength="10" required>
                            <ul class="error-list">
                                <li th:each="err : ${#fields.errors('mobile')}" th:text="#{${err}}" class="error text-danger"></li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <input class="form-control-sm" id="inquiry-email" name="email" value type="email"
                                   th:placeholder="#{contacts.emailPlaceholder}" th:field="*{email}" required >
                            <ul class="error-list">
                                <li th:each="err : ${#fields.errors('email')}" th:text="#{${err}}" class="error text-danger"></li>
                            </ul>
                        </div>


                        <div class="form-group form-group-textarea">
                            <span th:with="localizedVillageName=${#locale.language == 'bg' ? villageName :
                                (#locale.language == 'en' || #locale.language == 'de' ? villageLatinName : '')}">
                                <textarea class="form-control-sm form-message" name="userMessage" rows="4" placeholder="Съобщение"
                                          th:text="${inquiry.userMessage == null} ? #{inquiry.userMessage(#{village},${localizedVillageName},#{region},#{${regionName}})} : ${inquiry.userMessage}" required >
                                </textarea>
                                <ul class="error-list">
                                    <li th:each="err : ${#fields.errors('userMessage')}" th:text="#{${err}}" class="error text-danger"></li>
                                </ul>
                            </span>
                        </div>


                        <div class="form-group">
                            <select name="user_type" class="selectpicker form-control-sm bs-select-hidden" title="Избери" th:field="*{inquiryType}" required>
                                <option th:value="${T(com.ludogorieSoft.villagelifefrontend.enums.InquiryType).OTHER}" th:text="#{choose.type}"></option>
                                <option th:value="${inquiryType}" th:text="#{${inquiryType.name}}"  th:each="inquiryType : ${T(com.ludogorieSoft.villagelifefrontend.enums.InquiryType).values()}"></option>
                            </select>
                            <ul class="error-list">
                                <li th:each="err : ${#fields.errors('inquiryType')}" th:text="#{${err}}" class="error text-danger"></li>
                            </ul>
                        </div>

                        <div class="form-group">
                            <label class="control-checkbox" for="privacy_policy_checkbox">
                                <span class="custom-checkbox"></span>
                                <input type="checkbox" id="privacy_policy_checkbox" name="hasAgreed" th:field="*{hasAgreed}" required ><span th:text="#{send.message}" style="padding-left: 5px;"></span>
                                <a target="_blank" th:href="@{/villages/general-terms}" th:text="#{terms}">
                                </a>
                            </label>
                        </div>


                        <div class="form_messages"></div>

                        <div class="button-container">
                            <button type="submit" class="btn btn-secondary btn-half-width" th:text="#{send.village}">
                            </button>

                            <a href="tel:+359888393339" id="callBtn" class="btn btn-secondary-outlined btn-half-width" th:text="#{call}">
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    </div>
</div>

<div th:if="${isSent != null}">
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 5;">
        <div id="liveSubscriptionToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img th:src="@{/images/village-life-logo-icon.png}" class="rounded me-2" alt="logo"
                     style="width: 25px;">
                <strong class="me-auto">Village Life</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-subscription-body" style="margin: 15px; font-size: 16px;">
                <span th:if="${isSent}" th:text="#{send.successful}" style="color: green;"></span>
                <span th:if="${!isSent}" th:text="#{send.fail}" style="color: red;"></span>
            </div>
        </div>
    </div>
</div>

<div th:replace="fragments :: footer"></div>
<script src="/js/imageSlider.js"></script>
<script src="/js/accordion-script.js"></script>
<script src="/js/makeCallScript.js"></script>
<script src="/js/navScript.js"></script>
<script src="/js/handlePrint.js"></script>
<script src="/js/showSubscriptionToast.js"></script>
<script src="/js/playVideos.js"></script>
<script src="/js/toggleImagesAndVideos.js"></script>
<script src="/js/displayImages.js"></script>
<script th:inline="javascript">
        var videos = /*[[${videos}]]*/ [];
</script>
<script th:inline="javascript">
        loadVideo();
</script>
<script th:inline="javascript">
    if(videos.length == 0) {
        var images = document.getElementById('images');
        var videoContainer = document.getElementById('video-container');
        var toggleButton = document.getElementById('toggleButton');

        images.classList.remove('hidden');
        videoContainer.classList.add('hidden');
        toggleButton.classList.add('hidden');
    }
</script>
</body>
</html>